<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
        <ion-menu-button menu="m1"></ion-menu-button>
    </ion-buttons>
    <ion-title>Student Create Application</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">

    <ion-card class="card">

      <ion-card-content>
        <form [formGroup]="form" (ngSubmit)="createApplicaiton(form.value)">


          <ion-row>
            <ion-col *ngIf="existingApplication">
              <ion-label class="status" color="danger" *ngIf="form.get('status').value === 0">Hold</ion-label>
              <ion-label class="status" color="primary" *ngIf="form.get('status').value === 1">Approved</ion-label>
              <ion-label class="status" color="danger" *ngIf="form.get('status').value === 2">Declined</ion-label>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col>
              <ion-item lines="none">
                <ion-label>
                  Admission Number
                </ion-label>
              </ion-item>
  
              <ion-item [ngClass]="{
                'invalid':
                form.get('admissionNumber').errors &&
                  (form.get('admissionNumber').dirty ||
                  form.get('admissionNumber').touched ||formsubmitted ),
                'valid':
                  !form.get('admissionNumber').errors &&
                  (form.get('admissionNumber').dirty ||
                  form.get('admissionNumber').touched)
              }">
                <ion-input placeholder="Enter Admission Number" formControlName="admissionNumber"></ion-input>
              </ion-item>
            </ion-col>
  
            <ion-col>
              <ion-item lines="none">
                <ion-label>
                  Email Id
                </ion-label>
              </ion-item>
              <ion-item [ngClass]="{
                'invalid':
                form.get('emailId').errors &&
                  (form.get('emailId').dirty ||
                  form.get('emailId').touched ||formsubmitted ),
                'valid':
                  !form.get('emailId').errors &&
                  (form.get('emailId').dirty ||
                  form.get('emailId').touched)
              }">
              <ion-input placeholder="Enter Email Id" formControlName="emailId"></ion-input>
              </ion-item>
            </ion-col>
  
  
          </ion-row>
  
          <ion-row>
            
            <ion-col>
              <ion-item lines="none">
                <ion-label>
                  Phone Number
                </ion-label>
              </ion-item>
              <ion-item [ngClass]="{
                'invalid':
                form.get('phoneNumber').errors &&
                  (form.get('phoneNumber').dirty ||
                  form.get('phoneNumber').touched ||formsubmitted ),
                'valid':
                  !form.get('phoneNumber').errors &&
                  (form.get('phoneNumber').dirty ||
                  form.get('phoneNumber').touched)
              }">
                <ion-input placeholder="Enter Phone Number"   formControlName="phoneNumber"></ion-input>
              </ion-item>
            </ion-col>
  
            <ion-col>
              <ion-item lines="none">
                <ion-label>
                  Date of Applying
                </ion-label>
              </ion-item>
              <ion-item [ngClass]="{
                'invalid':
                form.get('dateApplied').errors &&
                  (form.get('dateApplied').dirty ||
                  form.get('dateApplied').touched ||formsubmitted ),
                'valid':
                  !form.get('dateApplied').errors &&
                  (form.get('dateApplied').dirty ||
                  form.get('dateApplied').touched)
              }">
              <ion-datetime displayFormat="DD/MM/YYYY" [min]="currentDate" [max]="currentDate" formControlName="dateApplied" placeholder="Select Date"></ion-datetime>
              </ion-item>
            </ion-col>
  
  
          </ion-row>
  
          <ion-row>
            <ion-col>
              <ion-item lines="none">
                <ion-label>
                  From
                </ion-label>
              </ion-item>
              <ion-item [ngClass]="{
                'invalid':
                form.get('from').errors &&
                  (form.get('from').dirty ||
                  form.get('from').touched ||formsubmitted ),
                'valid':
                  !form.get('from').errors &&
                  (form.get('from').dirty ||
                  form.get('from').touched)
              }">
              <ion-datetime  displayFormat="DD/MM/YYYY" [min]="currentDate" [max]="form.get('to').value?form.get('to').value:'2050-12-09'" formControlName="from" placeholder="Select Date"></ion-datetime>
              </ion-item>
            </ion-col>
  
            <ion-col>
              <ion-item lines="none">
                <ion-label>
                  To
                </ion-label>
              </ion-item>
              <ion-item [ngClass]="{
                'invalid':
                form.get('to').errors &&
                  (form.get('to').dirty ||
                  form.get('to').touched ||formsubmitted ),
                'valid':
                  !form.get('to').errors &&
                  (form.get('to').dirty ||
                  form.get('to').touched)
              }">
              <ion-datetime  displayFormat="DD/MM/YYYY" [min]="form.get('from').value?form.get('from').value:currentDate" max="2050-12-09" formControlName="to" placeholder="Select Date"></ion-datetime>
              </ion-item>
            </ion-col>
          </ion-row>
  
          <ion-row>
            <ion-col>
              <ion-item lines="none">
                <ion-label>
                  Subject
                </ion-label>
              </ion-item>
              <ion-item [ngClass]="{
                'invalid':
                form.get('subject').errors &&
                  (form.get('subject').dirty ||
                  form.get('subject').touched ||formsubmitted ),
                'valid':
                  !form.get('subject').errors &&
                  (form.get('subject').dirty ||
                  form.get('subject').touched)
              }">
              <ion-input placeholder="Enter Subject"   formControlName="subject"></ion-input>
              </ion-item>
            </ion-col>
          </ion-row>

          <ion-row>
            <ion-col>
              <ion-item lines="none">
                <ion-label>
                  Description
                </ion-label>
              </ion-item>
              <ion-item [ngClass]="{
                'invalid':
                form.get('description').errors &&
                  (form.get('description').dirty ||
                  form.get('description').touched ||formsubmitted ),
                'valid':
                  !form.get('description').errors &&
                  (form.get('description').dirty ||
                  form.get('description').touched)
              }">
              <ion-textarea rows="6" cols="20" formControlName="description" placeholder="Describe here"></ion-textarea>
              </ion-item>
            </ion-col>
          </ion-row>
  
  
          

          <ion-row>
            <ion-col>
              <ion-button *ngIf="existingApplication" type='submit' [disabled]="form.get('status').value !== 0">
                Update Application
              </ion-button>
              <ion-button *ngIf="!existingApplication" type='submit' [disabled]="form.get('status').value !== 0">
                Create Application
              </ion-button>
              <ion-button  type='button' [routerLink]="['../../','student-view-application']">
                Cancel
              </ion-button>
            </ion-col>
          </ion-row>
  
          <ion-row>
            <ion-col>
              <ion-label *ngIf="!this.form.valid && this.formsubmitted" color="danger">
                Red marked fields are required.
              </ion-label>
            </ion-col>
          </ion-row>
        </form>
      </ion-card-content>
    </ion-card>
</ion-content>
